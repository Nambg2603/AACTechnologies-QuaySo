<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AACTechnologies-Quay th∆∞·ªüng t·∫øt</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>

    <img src="anh1.png" class="decor-img side-img img-left" alt="Decor Left">
    <img src="anh2.png" class="decor-img side-img img-right" alt="Decor Right">
    <img src="anh3.png" class="decor-img img-top-right" alt="Decor Top Right">

    <div class="brand-container">
        <img src="logo2.png" alt="Company Brand" id="topLogo">
    </div>

    <button id="btnSettings" onclick="toggleSidebar()" title="Menu H·ªá Th·ªëng">
        üßß MENU
    </button>

    <div class="admin-sidebar" id="adminPanel">
        <div class="sidebar-header">
            <h2>QU·∫¢N TR·ªä VI√äN</h2>
            <button onclick="toggleSidebar()" class="close-sidebar">√ó</button>
        </div>
        
        <div class="sidebar-tabs">
            <button class="tab-btn active" onclick="switchTab('tab-winners')">DANH S√ÅCH</button>
            <button class="tab-btn" onclick="switchTab('tab-config')">C·∫§U H√åNH</button>
        </div>

        <div id="tab-winners" class="tab-content active">
            <div id="winnersList" class="winners-scroll">
                <div style="text-align: center; color: #ffcccb; margin-top: 20px;">Ch∆∞a c√≥ k·∫øt qu·∫£</div>
            </div>
        </div>

        <div id="tab-config" class="tab-content">
            <div class="status-panel">
                <div class="status-item" id="st-config"><span class="label">üìÇ Config:</span> <span class="val loading">Checking...</span></div>
                <div class="status-item" id="st-users"><span class="label">üë• Nh√¢n s·ª±:</span> <span class="val loading">Checking...</span></div>
                <div class="status-item" style="align-items: center; margin-top: 15px; border-top: 1px dashed #555; padding-top: 10px;">
                <span class="label" style="color: #ffaa00; font-weight: bold;">‚ú® Ch·∫ø ƒë·ªô L·ªôc B·∫•t Ng·ªù:</span>
                <label class="switch">
                    <input type="checkbox" id="toggleLucky" onchange="toggleLuckyBtn()">
                    <span class="slider round"></span>
                </label>
            </div>
            </div>
            <div class="admin-controls">
                <button id="btnExport" class="btn-action btn-success" onclick="exportWinners()" disabled>
                    üì• Xu·∫•t Excel Ngay
                </button>
                <button class="btn-action btn-danger" onclick="resetAll()">
                    ‚ö† Reset D·ªØ Li·ªáu
                </button>
            </div>
        </div>
    </div>

    <div class="main-stage">
        
        <div class="header-group">
            <div class="sub-title">C√¥ng ty TNHH AAC Technologies Vi·ªát Nam</div>
            <h1 class="main-title">Happy New Year</h1>
        </div>

        <div class="sphere-container" id="interactiveSphere" onclick="spin()">
            <img src="logo.png" class="center-logo" alt="Logo Center">
            <div id="tagCloud"></div>
        </div>

    </div>
    <button id="btnLucky" onclick="spinLucky()" style="display: none;">
    ‚ú® L·ªòC B·∫§T NG·ªú
    </button>
    <button id="btnSpinMain" onclick="spin()" disabled>
        QUAY TH∆Ø·ªûNG üå∏
    </button>

    <div id="resultModal" class="modal-overlay">
        <div class="modal-box tet-border">
            <div class="modal-header">
                <h3 id="modalPrizeName">GI·∫¢I TH∆Ø·ªûNG</h3>
            </div>
            
            <div class="modal-body-scroll">
                <div class="grid-header-note">DANH S√ÅCH TR√öNG TH∆Ø·ªûNG</div>
                <div id="rollingGrid" class="rolling-grid"></div>
            </div>

            <div class="modal-footer">
                <button id="btnCloseModal" class="btn-modal-action" onclick="closeModal()" disabled>ƒêANG QUAY...</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>